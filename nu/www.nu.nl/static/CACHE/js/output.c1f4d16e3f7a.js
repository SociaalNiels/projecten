;(function(factory){if(typeof define=='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports==='object'){module.exports=factory(require('jquery'));}else{factory(jQuery);}}(function($){var inviewObjects=[],viewportSize,viewportOffset,d=document,w=window,documentElement=d.documentElement,timer;$.event.special.inview={add:function(data){inviewObjects.push({data:data,$element:$(this),element:this});if(!timer&&inviewObjects.length){timer=setInterval(checkInView,250);}},remove:function(data){for(var i=0;i<inviewObjects.length;i++){var inviewObject=inviewObjects[i];if(inviewObject.element===this&&inviewObject.data.guid===data.guid){inviewObjects.splice(i,1);break;}}
if(!inviewObjects.length){clearInterval(timer);timer=null;}}};function getViewportSize(){var mode,domObject,size={height:w.innerHeight,width:w.innerWidth};if(!size.height){mode=d.compatMode;if(mode||!$.support.boxModel){domObject=mode==='CSS1Compat'?documentElement:d.body;size={height:domObject.clientHeight,width:domObject.clientWidth};}}
return size;}
function getViewportOffset(){return{top:w.pageYOffset||documentElement.scrollTop||d.body.scrollTop,left:w.pageXOffset||documentElement.scrollLeft||d.body.scrollLeft};}
function checkInView(){if(!inviewObjects.length){return;}
var i=0,$elements=$.map(inviewObjects,function(inviewObject){var selector=inviewObject.data.selector,$element=inviewObject.$element;return selector?$element.find(selector):$element;});viewportSize=viewportSize||getViewportSize();viewportOffset=viewportOffset||getViewportOffset();for(;i<inviewObjects.length;i++){if(!$.contains(documentElement,$elements[i][0])){continue;}
var $element=$($elements[i]),elementSize={height:$element[0].offsetHeight,width:$element[0].offsetWidth},elementOffset=$element.offset(),inView=$element.data('inview');if(!viewportOffset||!viewportSize){return;}
if(elementOffset.top+elementSize.height>viewportOffset.top&&elementOffset.top<viewportOffset.top+viewportSize.height&&elementOffset.left+elementSize.width>viewportOffset.left&&elementOffset.left<viewportOffset.left+viewportSize.width){if(!inView){$element.data('inview',true).trigger('inview',[true]);}}else if(inView){$element.data('inview',false).trigger('inview',[false]);}}}
$(w).bind("scroll resize scrollstop",function(){viewportSize=viewportOffset=null;});if(!documentElement.addEventListener&&documentElement.attachEvent){documentElement.attachEvent("onfocusin",function(){viewportOffset=null;});}}));;NU.socialBlock=new function(){var self=this,selector='.block.twitter .tweet-box, .block.instagram .content-box';self.init=function(element){$('body').on('click',selector,function(event){var block=$(this).closest('.block');if(event.target.nodeName!='A'&&$(event.target).closest('a').length<1){window.open(block.data('href'));event.preventDefault();}});};return self;};jQuery(document).ready(function(){NU.socialBlock.init();});;var NU=NU||{};NU.Overlay=function(settings){var self=this,_body=$('body'),_isActive=false,_loading=false,_hide,_empty,_destroy,settings=settings||{},_overlayName=settings.overlay_name||"NU_OverlayInstance_"+Math.floor(Math.random()*100000000),_overlay=$('.overlay'),_elements={ad:'#overlay_leaderboard_adspot',inner:'.overlay-content',title:'.overlay-title',footer:'.overlay-footer',close:' .overlay-close',destroy:'.overlay-destroy',content_bounding_box:'.overlay-content-boundary'},_default_classname='default',_classname=_default_classname;if(typeof settings.classname=='string'&&!!settings.classname.trim()){_classname=settings.classname.trim().replace(/\s+/,'.');}else{_classname=_overlayName;}
if($('.overlay.'+_classname).length<1){$('.overlay.'+_default_classname).clone().removeClass('default active').addClass(_classname.replace('.',' ')).insertAfter('.overlay.'+_default_classname);if('undefined'==typeof settings.allow_destroy){settings.allow_destroy=true;}}
_overlay=$('.overlay.'+_classname);_overlay.on('click keydown',_elements.close,function(event){if(event.type=='keydown'&&!(event.which==13||event.which==32)){return true;}
self.hide();});_overlay.on('click keydown',_elements.destroy,function(event){if(event.type=='keydown'&&!(event.which==13||event.which==32)){return true;}
self.destroy();});self.directAccessToContent=_overlay.find(_elements.inner);self.directAccessToFooter=_overlay.find(_elements.footer);self.directAccess=_overlay.find(_elements.inner).add(_overlay.find(_elements.footer));$(window).on('keydown.overlay',function(event){if(event.which==27&&_isActive){self.hide();ga('send','event',_overlayName,'close popup','esc');}});self.show=function(){_isActive=true;_body.addClass('overlay-active');_overlay.addClass('active');self.listening_element.trigger('show_overlay');};self.hide=function(){_hide();self.listening_element.trigger('hide_overlay');};_hide=function(){switch((""+settings.on_hide).toLowerCase()){case'destroy':_destroy();break;case'empty':_empty();break;}
_isActive=false;_body.removeClass('overlay-active');_overlay.removeClass('active');};_destroy=function(){_overlay.find(_elements.outer).remove();};_empty=function(){_overlay.find(_elements.inner).empty();_overlay.find(_elements.footer).empty();_overlay.find(_elements.ad).empty();};self.destroy=function(){if(settings.allow_destroy){self.hide();_destroy();return true;}else{return false;}};self.showLoader=function(){_hide();_loading=true;_body.addClass('overlay-loading');_overlay.addClass('active');self.listening_element.trigger('loading_overlay');};self.hideLoader=function(){_loading=false;_body.removeClass('overlay-loading');_overlay.removeClass('active');self.listening_element.trigger('loadingcomplete_overlay');};self.getTitle=function(){return _overlay.find(_elements.title).contents();};self.setTitle=function(newTitle){_overlay.find(_elements.title).empty().append(newTitle);};self.getContent=function(){return _overlay.find(_elements.inner).contents();};self.setContent=function(newContent){_overlay.find(_elements.inner).empty().append(newContent);};self.getFooterContent=function(){return _overlay.find(_elements.footer).contents()};self.setFooterContent=function(newContent){if(!!newContent){_overlay.find(_elements.footer).empty().append(newContent);}else{_overlay.find(_elements.footer).hide();}};self.isVisible=function(visibility){if(arguments.length!=1){return _isActive}
if(!!visibility){self.show();}else{self.hide();}
return _isActive;};self.isLoading=function(loading){if(arguments.length!=1){return _loading;}
if(!!loading){self.showLoader();}else{self.hideLoader();}
return _loading;};self.listening_element=_overlay;_overlay.data('name',settings.overlay_name||settings.classname);if('undefined'!=typeof settings.content){self.setContent(settings.content);}
if('undefined'!=typeof settings.footer_content){self.setFooterContent(settings.footer_content);}
if('undefined'!=typeof settings.title){self.setTitle(settings.title);}
return self;};;NU.namespace('NU.Blocks.Toast');NU.Blocks.Toast.Base=NU.Block.extend({initialize:function(){this.container.find('a.close').click(jQuery.proxy(this.close,this));if(this.shouldToast()&&!this.keepHidden()){this.open();}},keepHidden:function(){return false;},shouldToast:function(){return false;},open:function(){this.container.show();},close:function(){this.container.slideUp();}});;NU.namespace('NU.Blocks.Toast');NU.Blocks.Toast.AdBlocker=NU.Blocks.Toast.Base.extend({shouldToast:function(){if(isAdBlockEnabled){return true;}
document.addEventListener("adblocker.isAdBlockEnabled",({isAdBlockEnabled})=>{if(isAdBlockEnabled){this.open();}},{once:true});},close:function(){this.container.slideUp();},keepHidden:function(){return false;}});NU.BlockManager.register('toast.adblocker',NU.Blocks.Toast.AdBlocker);;NU.contributionFlow=new function(){var self=this,_contribution_overlay=new NU.Overlay({overlay_name:'contribution_flow',classname:'contribution-flow'}),_elements={overlay:_contribution_overlay.directAccess,notification:_contribution_overlay.directAccess.find('.dynamic-notification'),textarea:_contribution_overlay.directAccess.find('.contribution-entry'),submit:_contribution_overlay.directAccess.find('.btn.submit'),filedragdrop:_contribution_overlay.directAccess.find('.filedragdrop')},_confirmation_footer=''+'<div class="left-col"></div>'+'<div class="right-col">'+'<a class="btn inverted overlay-close">Terug naar artikel</a>'+'</div>',_timeout,_url='/api/users/id/{gigya_uid}/contributions',_news_id,_submissionSuccess,_submissionError,_reset,_filedragdrop=new FileDragDrop(_elements.filedragdrop,12);self.start=function(news_id){if(news_id){_news_id=news_id;}
_contribution_overlay.show();};self.submit=function(){if(!_filedragdrop.isFinished()){self.showNotification('warning','Versturen kan pas als alle uploads zijn verwerkt.');return false;}
_contribution_overlay.showLoader();var data={text:_elements.textarea.val(),news_id:_news_id,media:[]};for(var file in _filedragdrop.files){if(_filedragdrop.files.hasOwnProperty(file)){data.media.push({key:_filedragdrop.files[file].url,type:_filedragdrop.files[file].filetype});}}
function _submit(gigya_info){data['G-SignatureTimestamp']=gigya_info.signatureTimestamp;data['G-UidSignature']=gigya_info.UIDSignature;$.ajax({url:_url.replace('{gigya_uid}',gigya_info.UID),method:"post",contentType:'application/json',data:JSON.stringify(data),success:function(){_submissionSuccess()},error:function(jqxhr,textStatus,error){_submissionError('error','Verzenden mislukt. Probeer nogmaals.');}});}
NU.account.api.getAccountInfo({callback:_submit});};_reset=function(){_elements.textarea.val("");self.hideNotification();_contribution_overlay.hide();_filedragdrop.reset();};_elements.overlay.on('click keydown','.btn.submit',function(event){if($(this).is('.disabled')){event.preventDefault();return;}
if(event.type=='keydown'&&!(event.which==13||event.which==32)){return true;}
event.preventDefault();if((!_elements.textarea.val()||_elements.textarea.val().trim().length<1)&&Object.keys(_filedragdrop.files).length==0){self.showNotification('error','Je hebt geen bericht ingevuld om te verzenden!');}else{self.submit();}});_elements.overlay.on('keyup change','.contribution-entry',function(event){if(!!_elements.textarea.val()){self.hideNotification();}});_elements.overlay.on('click keydown','.login-notification a',function(event){if(event.type=='keydown'&&!(event.which==13||event.which==32)){return true;}
document.querySelector('body').addEventListener('NU.account.login',()=>{_contribution_overlay.show();},{once:true,});_contribution_overlay.hide();NU.account.interactions.login();});self.showNotification=function(classname,text){_elements.notification.removeClass('error warning').addClass(classname).html(text).show();};self.hideNotification=function(){_elements.notification.html('').hide();};_submissionSuccess=function(title,text){window.clearTimeout(_timeout);_contribution_overlay.hideLoader();_reset();title=title||'Versturen geslaagd';text=text||'<p>Bedankt voor je bijdrage!</p>';(new NU.Overlay({overlay_name:'contribution_confirm',classname:'contribution-confirm narrow',title:'<i class="fa fa-check" aria-hidden="true"></i> '+title,content:text,footer_content:_confirmation_footer,allow_destroy:true,on_hide:'destroy'})).show();};_submissionError=function(classname,text){window.clearTimeout(_timeout);self.showNotification(classname,text);_contribution_overlay.hideLoader();_contribution_overlay.show();}};$('body').on('click keydown','.contribution_trigger',function(event){if(event.type=='keydown'&&!(event.which==13||event.which==32)){return true;}
NU.contributionFlow.start($(this).data('article_id'));event.preventDefault();});;(function(){var plistaArticlesBlock=$('.block.tealium.recomm #recomm'),plistaArticlesWrapperClass='plistaAllOuter',plistaArticlesItemSelector='.plistaList > a.itemLink',getRecommendedArticleId=function(article){if($(article).hasClass('itemLinkPET')){return'external';}else{var articleIdRegexString=/\.nu\.nl\/[\w.]+\/(\d+)\/.*\.html/i;var match=article.getAttribute('data-lpurl').match(articleIdRegexString);if(!!match&&match.length>1){return match[1];}else{return"";}}},getRecsData=function(items){return{algorithm:'plista',context:'aanbevolen_artikelen',site:'nunl',items:items}},getRecsItem=function(article_id){return{sit:'nunl',cid:article_id,type:'article'}},convertArticlesForSacEvent=function(articles){var items=[];for(var i=0;i<articles.length;i++){var article=articles[i],article_id=getRecommendedArticleId(article);if(typeof article_id!=='undefined'){items.push(getRecsItem(article_id));}}
return items;},sendPlistaRecommendationsShown=function(articles){var sacArticlesItems=convertArticlesForSacEvent(articles);var recs_data=getRecsData(sacArticlesItems);NU.helpers.retry(function(){recommendations.recommendations_shown(recs_data);});},setOnClickEvent=function(articlesElements){$(articlesElements).click(function(e){var clickedArticle=e.currentTarget,sacArticlesItems=$('.'+plistaArticlesWrapperClass+' '+plistaArticlesItemSelector),sacData=getRecsData(convertArticlesForSacEvent(sacArticlesItems)),recItem=getRecsItem(getRecommendedArticleId(clickedArticle));NU.helpers.retry(function(){recommendations.recommendations_clicked(sacData,recItem);});});};$(document).ready(function(){if(plistaArticlesBlock.length>0){var plistaArticlesObserver=new MutationObserver(function(mutations){mutations.forEach(function(mutation){for(var i=0;i<mutation.addedNodes.length;i++){var addedNode=$(mutation.addedNodes[i]);if(addedNode.hasClass(plistaArticlesWrapperClass)){sendPlistaRecommendationsShown(addedNode.find(plistaArticlesItemSelector));setOnClickEvent(addedNode.find(plistaArticlesItemSelector));plistaArticlesObserver.disconnect();}}})});var config={childList:true,subtree:true};plistaArticlesObserver.observe(plistaArticlesBlock[0],config);}});})();